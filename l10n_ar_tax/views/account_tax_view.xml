<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_tax_form" model="ir.ui.view">
        <field name="name">account.tax.form</field>
        <field name="model">account.tax</field>
        <field name="inherit_id" ref="account.view_tax_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='amount']/.." position="after">
                <field name="l10n_ar_state_id" invisible="l10n_ar_tribute_afip_code != '07'" required="l10n_ar_tribute_afip_code == '07'" options="{'no_create': True}"/>
            </xpath>
            <!-- limpiamos esta seccion que para retenciones no tiene sentido -->
            <group name="advanced_booleans" position="attributes">
                <attribute name="invisible">l10n_ar_withholding_payment_type</attribute>
            </group>

            <!-- TODO mejorar esto, por ahora solo lo hacemos visible con este grupo ya que este grupo solo lo estamos usando en realidad para API, deberiamos ver de hacerlo de otra manera -->
            <!-- TODO agregar que sea de santa fe -->
            <!-- <i class="fa fa-exclamation-circle" data-tooltip="This field will not be taken into account for sales that come from eCommerce, in this case you must configure it directly in Settings" title="This field will not be taken into account for sales that come from eCommerce, in this case you must configure it directly in Settings" aria-hidden="true"/>  -->
            <!-- <group>
                <field name="api_codigo_articulo_retencion" invisible="type_tax_use == 'none' and country_code == 'AR'"/>
                <field name="api_articulo_inciso_calculo_retencion" invisible="type_tax_use == 'none' and country_code == 'AR'"/>
                <field name="api_codigo_articulo_percepcion" invisible="l10n_ar_tribute_afip_code != '07'"/>
                <field name="api_articulo_inciso_calculo_percepcion" invisible="l10n_ar_tribute_afip_code != '07'"/>
            </group> -->
            <!-- <sheet>
                <p>
                    Utilizado para la generación del TXT para SIRCAR.<br/>
                    Tipo de Régimen de Retención/precición (código correspondiente según tabla definida por la jurisdicción).<br/>
                    Puede consultar la tabla <a target="_blank" href="https://www.ca.gov.ar/sircar2">aquí</a>, sección "Instructivos y tablas" item "Tabla con la Tipificación de Regímenes..."
                </p>
            </sheet>
                    <page string="SIRCAR">
                        <group>
                            <field name="regimen_percepcion"/>
                            <field name="regimen_retencion"/>
                        </group>
                    </page> -->

            <!-- <notebook>
                <page string="API">
                    <group>
                    </group>
                </page>
            </notebook> -->
        </field>
    </record>

    <record id="view_account_tax_search" model="ir.ui.view">
        <field name="name">account.tax.search</field>
        <field name="model">account.tax</field>
        <field name="inherit_id" ref="account.view_account_tax_search"/>
        <field name="arch" type="xml">
            <filter name="purchase" position="after">
                <filter string="AR Customer Withholding" name="customer" domain="[('type_tax_use', '=', 'none'), ('country_code', '=', 'AR'), ('l10n_ar_withholding_payment_type', '=', 'customer')]"/>
                <filter string="AR Supplier Withholding" name="supplier" domain="[('type_tax_use', '=', 'none'), ('country_code', '=', 'AR'), ('l10n_ar_withholding_payment_type', '=', 'supplier')]"/>
            </filter>
        </field>
    </record>

    <record id="action_withholding_tax_form" model="ir.actions.act_window">
        <field name="name">AR Withholding Taxes</field>
        <field name="res_model">account.tax</field>
        <field name="view_mode">list,form</field>
        <field name="domain" eval="False"/>
        <field name="context">{'search_default_customer': True, 'search_default_supplier': True, 'default_type_tax_use': 'supplier', 'active_test': False}</field>
        <field name="view_id" ref="account.view_tax_tree"/>
    </record>

    <menuitem action="action_withholding_tax_form" id="menu_withholding_tax_form" parent="account.root_payment_menu" sequence="1"/>

</odoo>

